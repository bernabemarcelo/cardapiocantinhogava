<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Digital</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Playfair+Display:wght@700&family=Montserrat:wght@400;500;600&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        .overlay {
            background: rgba(0, 0, 0, 0.7);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 100px;
        }
        
        .container { max-width: 1200px; margin: 0 auto; }
        
        .firebase-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .firebase-status.connected { color: #27ae60; }
        .firebase-status.disconnected { color: #e74c3c; }
        .firebase-status i { font-size: 10px; }
        
        header {
            text-align: center;
            color: white;
            padding: 30px 20px;
            margin-bottom: 30px;
        }
        
        header h1 {
            font-family: var(--title-font);
            font-size: var(--title-size);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-weight: 700;
            color: var(--title-color);
        }
        
        header p {
            font-family: var(--subtitle-font);
            font-size: var(--subtitle-size);
            opacity: 0.9;
            font-weight: 300;
            color: var(--subtitle-color);
        }
        
        .contact-bar {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--contact-color);
            text-decoration: none;
            font-size: var(--contact-size);
            transition: transform 0.3s;
            padding: 8px 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .contact-item:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.2);
        }
        
        .contact-item i { font-size: 1.3em; }
        
        .categories-nav {
            display: flex;
            gap: 10px;
            padding: 20px;
            overflow-x: auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .category-btn {
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
            font-family: var(--body-font);
            font-weight: 500;
        }
        
        .category-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .category-btn.active {
            background: #ff6b6b;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            padding: 20px;
        }
        
        .menu-item {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .menu-item:hover { transform: translateY(-5px); }
        
        .menu-item img {
            width: 100%;
            height: var(--image-height, 200px);
            object-fit: cover;
        }
        
        .menu-item-content { padding: 20px; }
        
        .menu-item h3 {
            font-family: var(--item-title-font);
            color: var(--item-title-color);
            margin-bottom: 10px;
            font-size: var(--item-title-size);
            font-weight: 600;
        }
        
        .menu-item p {
            font-family: var(--item-description-font);
            color: var(--item-description-color);
            margin-bottom: 15px;
            line-height: 1.6;
            font-weight: 400;
            font-size: var(--item-description-size);
        }
        
        .menu-item .price {
            font-family: var(--price-font);
            color: var(--price-color);
            font-size: var(--price-size);
            font-weight: 700;
        }
        
        .menu-item .category-tag {
            display: inline-block;
            padding: 4px 12px;
            background: #f0f0f0;
            border-radius: 12px;
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .cart-float {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #ff6b6b;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(255, 107, 107, 0.5);
            z-index: 1500;
            transition: all 0.3s;
        }
        
        .cart-float:hover { transform: scale(1.1); }
        
        .cart-float .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #fff;
            color: #ff6b6b;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            color: white;
            padding: 30px 20px;
            margin-top: 40px;
            font-family: var(--body-font);
            position: relative;
        }
        
        footer p { opacity: 0.8; margin-top: 10px; }
        
        .admin-btn {
            display: inline-block;
            background: rgba(255, 107, 107, 0.8);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            font-family: var(--body-font);
            font-weight: 500;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .admin-btn:hover {
            background: rgba(255, 82, 82, 0.9);
            transform: scale(1.05);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            overflow-y: auto;
        }
        
        .modal-content {
            background: white;
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            position: relative;
            font-family: var(--body-font);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-content.large { max-width: 800px; }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 30px;
            cursor: pointer;
            color: #666;
        }
        
        .close-modal:hover { color: #333; }
        
        .form-group { margin-bottom: 20px; }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-family: var(--body-font);
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: var(--body-font);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .form-group small {
            color: #666;
            font-size: 0.9em;
            display: block;
            margin-top: 5px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
            cursor: pointer;
        }
        
        .checkbox-group label {
            margin: 0;
            cursor: pointer;
            font-weight: normal;
        }
        
        .btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-family: var(--body-font);
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover { background: #ff5252; }
        .btn-secondary { background: #666; }
        .btn-secondary:hover { background: #555; }
        .btn-success { background: #27ae60; }
        .btn-success:hover { background: #229954; }
        
        .admin-panel {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .admin-panel h2 {
            font-family: var(--title-font);
            color: #333;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .item-list { margin-top: 20px; }
        
        .item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .item-row:hover { background: #f9f9f9; }
        
        .item-actions button {
            margin-left: 10px;
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .color-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .color-input-group input[type="color"] {
            width: 60px;
            height: 40px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .color-input-group input[type="text"] { flex: 1; }
        
        .image-upload-area {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .image-upload-area:hover {
            border-color: #ff6b6b;
            background: #fff5f5;
        }
        
        .image-upload-area.has-image { border-color: #27ae60; }
        
        .image-preview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 10px;
            border-radius: 8px;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .cart-item-info { flex: 1; }
        
        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .qty-btn {
            width: 30px;
            height: 30px;
            border: none;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
        }
        
        .qty-btn:hover { background: #ff5252; }
        
        .cart-total {
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            text-align: right;
        }
        
        @media (max-width: 768px) {
            header h1 { font-size: calc(var(--title-size) * 0.8); }
            .contact-bar { flex-direction: column; gap: 10px; }
            .contact-item { width: 100%; justify-content: center; }
            .menu-grid { grid-template-columns: 1fr; padding: 10px; }
            .modal-content { margin: 20px; padding: 20px; }
            .firebase-status { top: 10px; right: 10px; font-size: 11px; padding: 6px 12px; }
            .categories-nav { padding: 10px; }
            .cart-float { bottom: 80px; }
        }
    </style>
</head>
<body>
    <div class="overlay">
        <div class="firebase-status disconnected" id="firebaseStatus">
            <i class="fas fa-circle"></i>
            <span>Conectando...</span>
        </div>

        <div class="container">
            <header>
                <h1 id="restaurantName">Meu Restaurante</h1>
                <p id="restaurantSubtitle">Sabores que encantam</p>
                <div class="contact-bar" id="contactBar"></div>
            </header>

            <div class="categories-nav" id="categoriesNav">
                <button class="category-btn active" onclick="filterCategory('all')">üçΩÔ∏è Todos</button>
            </div>

            <div id="adminPanel" style="display: none;">
                <div class="admin-panel">
                    <h2>Painel Administrativo</h2>
                    
                    <button class="btn" onclick="showSettingsModal()">‚öôÔ∏è Configura√ß√µes</button>
                    <button class="btn" onclick="showContactModal()">üìû Contatos</button>
                    <button class="btn" onclick="showStyleModal()">üé® Estilos</button>
                    <button class="btn" onclick="showCategoriesModal()">üìÅ Categorias</button>
                    <button class="btn" onclick="showAddItemModal()">‚ûï Adicionar Item</button>
                    <button class="btn-secondary btn" onclick="logout()">üö™ Sair</button>

                    <div class="item-list" id="itemList"></div>
                </div>
            </div>

            <div class="menu-grid" id="menuGrid"></div>

            <div class="cart-float" onclick="showCartModal()" style="display: none;" id="cartFloat">
                <i class="fas fa-shopping-cart fa-2x"></i>
                <div class="cart-count" id="cartCount">0</div>
            </div>

            <footer>
                <div class="contact-bar" id="contactBarFooter"></div>
                <p>¬© 2024 <span id="footerName">Meu Restaurante</span>. Todos os direitos reservados.</p>
                <button class="admin-btn" onclick="showLoginModal()">üîê Admin</button>
            </footer>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('loginModal')">&times;</span>
            <h2>üîê Login Administrativo</h2>
            <div class="form-group">
                <label>Senha:</label>
                <input type="password" id="loginPassword" placeholder="Digite a senha">
            </div>
            <button class="btn" onclick="login()">Entrar</button>
        </div>
    </div>

    <div id="categoriesModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('categoriesModal')">&times;</span>
            <h2>üìÅ Gerenciar Categorias</h2>
            
            <div class="form-group">
                <label>Nova Categoria:</label>
                <input type="text" id="newCategoryName" placeholder="Ex: Bebidas, Pratos Quentes">
            </div>
            <button class="btn" onclick="addCategory()">‚ûï Adicionar</button>
            
            <div id="categoriesList" style="margin-top: 20px;"></div>
            
            <button class="btn-secondary btn" onclick="closeModal('categoriesModal')">Fechar</button>
        </div>
    </div>

    <div id="contactModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('contactModal')">&times;</span>
            <h2>üìû Editar Contatos</h2>

            <div class="checkbox-group">
                <input type="checkbox" id="showWhatsapp" checked>
                <label for="showWhatsapp">Mostrar WhatsApp</label>
            </div>
            <div class="form-group">
                <label><i class="fab fa-whatsapp"></i> WhatsApp:</label>
                <input type="text" id="contactWhatsapp" placeholder="(11) 99999-9999">
                <small>N√∫mero para receber pedidos</small>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="showPhone">
                <label for="showPhone">Mostrar Telefone</label>
            </div>
            <div class="form-group">
                <label><i class="fas fa-phone"></i> Telefone:</label>
                <input type="text" id="contactPhone" placeholder="(11) 3333-4444">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="showInstagram" checked>
                <label for="showInstagram">Mostrar Instagram</label>
            </div>
            <div class="form-group">
                <label><i class="fab fa-instagram"></i> Instagram:</label>
                <input type="text" id="contactInstagram" placeholder="@seurestaurante">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="showFacebook">
                <label for="showFacebook">Mostrar Facebook</label>
            </div>
            <div class="form-group">
                <label><i class="fab fa-facebook"></i> Facebook:</label>
                <input type="text" id="contactFacebook" placeholder="facebook.com/seurestaurante">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="showEmail" checked>
                <label for="showEmail">Mostrar E-mail</label>
            </div>
            <div class="form-group">
                <label><i class="fas fa-envelope"></i> E-mail:</label>
                <input type="email" id="contactEmail" placeholder="contato@restaurante.com">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="showAddress" checked>
                <label for="showAddress">Mostrar Endere√ßo</label>
            </div>
            <div class="form-group">
                <label><i class="fas fa-map-marker-alt"></i> Endere√ßo:</label>
                <input type="text" id="contactAddress" placeholder="Rua Exemplo, 123">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="showHours" checked>
                <label for="showHours">Mostrar Hor√°rio</label>
            </div>
            <div class="form-group">
                <label><i class="fas fa-clock"></i> Hor√°rio:</label>
                <input type="text" id="contactHours" placeholder="Seg-Sex: 11h-23h">
            </div>

            <button class="btn" onclick="saveContacts()">üíæ Salvar</button>
            <button class="btn-secondary btn" onclick="closeModal('contactModal')">Cancelar</button>
        </div>
    </div>

    <div id="styleModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('styleModal')">&times;</span>
            <h2>üé® Personalizar Estilos</h2>

            <h3 style="margin-top: 20px; color: #333;">üìè Tamanhos</h3>

            <div class="form-group">
                <label>Altura das Imagens:</label>
                <input type="range" id="imageHeight" min="100" max="400" value="200" oninput="updateImageHeight()">
                <small id="imageHeightValue">200px</small>
            </div>

            <div class="form-group">
                <label>Tamanho do T√≠tulo:</label>
                <input type="range" id="titleSize" min="20" max="60" value="40" oninput="updateSizePreview('title')">
                <small id="titleSizeValue">40px</small>
            </div>

            <div class="form-group">
                <label>Tamanho do Subt√≠tulo:</label>
                <input type="range" id="subtitleSize" min="14" max="30" value="19" oninput="updateSizePreview('subtitle')">
                <small id="subtitleSizeValue">19px</small>
            </div>

            <h3 style="margin-top: 30px; color: #333;">üé® Cores</h3>

            <div class="form-group">
                <label>Cor do T√≠tulo:</label>
                <div class="color-input-group">
                    <input type="color" id="titleColor" value="#ffffff" onchange="updateColorText('title')">
                    <input type="text" id="titleColorText" value="#ffffff" readonly>
                </div>
            </div>

            <div class="form-group">
                <label>Cor do Subt√≠tulo:</label>
                <div class="color-input-group">
                    <input type="color" id="subtitleColor" value="#ffffff" onchange="updateColorText('subtitle')">
                    <input type="text" id="subtitleColorText" value="#ffffff" readonly>
                </div>
            </div>

            <button class="btn" onclick="saveStyles()">üíæ Salvar</button>
            <button class="btn-secondary btn" onclick="closeModal('styleModal')">Cancelar</button>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('settingsModal')">&times;</span>
            <h2>‚öôÔ∏è Configura√ß√µes Gerais</h2>
            <div class="form-group">
                <label>Nome do Restaurante:</label>
                <input type="text" id="settingsName" placeholder="Nome">
            </div>
            <div class="form-group">
                <label>Subt√≠tulo:</label>
                <input type="text" id="settingsSubtitle" placeholder="Subt√≠tulo">
            </div>
            <div class="form-group">
                <label>URL da Imagem de Fundo:</label>
                <input type="text" id="settingsBackground" placeholder="https://exemplo.com/imagem.jpg">
            </div>
            <div class="form-group">
                <label>Senha de Admin:</label>
                <input type="password" id="settingsPassword" placeholder="Nova senha">
            </div>
            <button class="btn" onclick="saveSettings()">üíæ Salvar</button>
            <button class="btn-secondary btn" onclick="closeModal('settingsModal')">Cancelar</button>
        </div>
    </div>

    <div id="itemModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('itemModal')">&times;</span>
            <h2 id="itemModalTitle">‚ûï Adicionar Item</h2>
            
            <div class="form-group">
                <label>Categoria:</label>
                <select id="itemCategory"></select>
            </div>

            <div class="form-group">
                <label>Nome do Prato:</label>
                <input type="text" id="itemName" placeholder="Ex: Pizza Margherita">
            </div>
            
            <div class="form-group">
                <label>Descri√ß√£o:</label>
                <textarea id="itemDescription" placeholder="Descri√ß√£o"></textarea>
            </div>
            
            <div class="form-group">
                <label>Pre√ßo (R$):</label>
                <input type="text" id="itemPrice" placeholder="35.90">
            </div>
            
            <div class="form-group">
                <label>Imagem:</label>
                <div class="image-upload-area" id="imageUploadArea" onclick="document.getElementById('itemImageFile').click()">
                    <i class="fas fa-cloud-upload-alt fa-3x" style="color: #ddd;"></i>
                    <p>üì∏ Clique para fazer upload ou tirar foto</p>
                    <img id="imagePreview" class="image-preview" style="display: none;">
                </div>
                <input type="file" id="itemImageFile" accept="image/*" capture="environment" style="display: none;" onchange="previewImage(this)">
                <small>Ou cole a URL:</small>
                <input type="text" id="itemImage" placeholder="https://exemplo.com/imagem.jpg" style="margin-top: 10px;">
            </div>
            
            <button class="btn" onclick="saveItem()">üíæ Salvar</button>
            <button class="btn-secondary btn" onclick="closeModal('itemModal')">Cancelar</button>
        </div>
    </div>

    <div id="cartModal" class="modal">
        <div class="modal-content large">
            <span class="close-modal" onclick="closeModal('cartModal')">&times;</span>
            <h2>üõí Seu Pedido</h2>
            
            <div id="cartItems"></div>
            
            <div class="cart-total" id="cartTotal">Total: R$ 0,00</div>
            
            <div class="form-group" style="margin-top: 20px;">
                <label>üë§ Seu Nome:</label>
                <input type="text" id="customerName" placeholder="Digite seu nome">
            </div>
            
            <div class="form-group">
                <label>üìç Localiza√ß√£o (Mesa/Quarto/Endere√ßo):</label>
                <input type="text" id="customerLocation" placeholder="Ex: Mesa 5">
            </div>
            
            <button class="btn btn-success" onclick="sendOrder()" style="width: 100%; font-size: 18px; padding: 15px;">
                <i class="fab fa-whatsapp"></i> Enviar Pedido pelo WhatsApp
            </button>
            <button class="btn-secondary btn" onclick="closeModal('cartModal')" style="width: 100%; margin-top: 10px;">
                Continuar Comprando
            </button>
        </div>
    </div>

    <div id="itemDetailModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('itemDetailModal')">&times;</span>
            <div id="itemDetailContent"></div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB2k6gxxExHWOkYWRPwSDald6Sd22N8BNM",
            authDomain: "cardapio-cantinho-gava.firebaseapp.com",
            databaseURL: "https://cardapio-cantinho-gava-default-rtdb.firebaseio.com/",
            projectId: "cardapio-cantinho-gava",
            storageBucket: "cardapio-cantinho-gava.firebasestorage.app",
            messagingSenderId: "250618497333",
            appId: "1:250618497333:web:022ae360f0e923eda8247c"
        };

        let settings = {
            name: 'Meu Restaurante',
            subtitle: 'Sabores que encantam',
            background: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1920',
            password: 'admin123'
        };

        let contacts = {
            whatsapp: '5511999999999',
            phone: '',
            instagram: '@meurestaurante',
            facebook: '',
            email: 'contato@restaurante.com',
            address: 'Rua Exemplo, 123',
            hours: 'Seg-Sex: 11h-23h',
            showWhatsapp: true,
            showPhone: false,
            showInstagram: true,
            showFacebook: false,
            showEmail: true,
            showAddress: true,
            showHours: true
        };

        let styles = {
            imageHeight: '200px',
            titleSize: '40px',
            subtitleSize: '19px',
            itemTitleSize: '22px',
            itemDescriptionSize: '16px',
            priceSize: '24px',
            contactSize: '16px',
            titleColor: '#ffffff',
            subtitleColor: '#ffffff',
            itemTitleColor: '#333333',
            itemDescriptionColor: '#666666',
            priceColor: '#ff6b6b',
            contactColor: '#ffffff',
            titleFont: "'Playfair Display', serif",
            subtitleFont: "'Poppins', sans-serif",
            itemTitleFont: "'Poppins', sans-serif",
            itemDescriptionFont: "'Poppins', sans-serif",
            priceFont: "'Poppins', sans-serif"
        };

        let categories = ['Bebidas', 'Pratos Principais', 'Sobremesas'];
        let menuItems = [];
        let cart = [];
        let isLoggedIn = false;
        let editingItemId = null;
        let firebaseApp = null;
        let database = null;
        let storage = null;
        let currentFilter = 'all';
        let uploadedImageData = null;

        function initFirebase() {
            try {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                storage = firebase.storage();
                updateFirebaseStatus(true);
                loadFromFirebase();
            } catch (error) {
                console.error('Erro Firebase:', error);
                updateFirebaseStatus(false);
                loadFromLocalStorage();
            }
        }

        function updateFirebaseStatus(connected) {
            const statusEl = document.getElementById('firebaseStatus');
            if (connected) {
                statusEl.className = 'firebase-status connected';
                statusEl.innerHTML = '<i class="fas fa-circle"></i><span>Conectado ‚òÅÔ∏è</span>';
            } else {
                statusEl.className = 'firebase-status disconnected';
                statusEl.innerHTML = '<i class="fas fa-circle"></i><span>Modo Local</span>';
            }
        }

        function loadFromFirebase() {
            if (!database) return;
            database.ref('settings').once('value').then((s) => { if (s.exists()) { settings = s.val(); applySettings(); } });
            database.ref('contacts').once('value').then((s) => { if (s.exists()) { contacts = s.val(); renderContacts(); } });
            database.ref('styles').once('value').then((s) => { if (s.exists()) { styles = s.val(); applyStyles(); } });
            database.ref('categories').once('value').then((s) => { if (s.exists()) { categories = s.val(); renderCategories(); } });
            database.ref('menuItems').once('value').then((s) => { if (s.exists()) { menuItems = Object.values(s.val()); renderMenu(); } });
        }

        function saveToFirebase(path, data) { if (database) database.ref(path).set(data); }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('menuData');
            if (saved) {
                const data = JSON.parse(saved);
                settings = data.settings || settings;
                contacts = data.contacts || contacts;
                styles = data.styles || styles;
                categories = data.categories || categories;
                menuItems = data.menuItems || menuItems;
            }
            applySettings();
            applyStyles();
            renderContacts();
            renderCategories();
            renderMenu();
        }

        function saveToLocalStorage() {
            localStorage.setItem('menuData', JSON.stringify({ settings, contacts, styles, categories, menuItems }));
        }

        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImageData = e.target.result;
                    document.getElementById('imagePreview').src = e.target.result;
                    document.getElementById('imagePreview').style.display = 'block';
                    document.getElementById('imageUploadArea').classList.add('has-image');
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function renderContacts() {
            let html = '';
            if (contacts.showWhatsapp && contacts.whatsapp) {
                const num = contacts.whatsapp.replace(/\\D/g, '');
                html += `<a href="https://wa.me/${num}" target="_blank" class="contact-item"><i class="fab fa-whatsapp"></i> ${contacts.whatsapp}</a>`;
            }
            if (contacts.showPhone && contacts.phone) html += `<a href="tel:${contacts.phone}" class="contact-item"><i class="fas fa-phone"></i> ${contacts.phone}</a>`;
            if (contacts.showInstagram && contacts.instagram) {
                const user = contacts.instagram.replace('@', '');
                html += `<a href="https://instagram.com/${user}" target="_blank" class="contact-item"><i class="fab fa-instagram"></i> ${contacts.instagram}</a>`;
            }
            if (contacts.showFacebook && contacts.facebook) html += `<a href="${contacts.facebook.includes('http') ? contacts.facebook : 'https://facebook.com/' + contacts.facebook}" target="_blank" class="contact-item"><i class="fab fa-facebook"></i> Facebook</a>`;
            if (contacts.showEmail && contacts.email) html += `<a href="mailto:${contacts.email}" class="contact-item"><i class="fas fa-envelope"></i> ${contacts.email}</a>`;
            if (contacts.showAddress && contacts.address) html += `<div class="contact-item"><i class="fas fa-map-marker-alt"></i> ${contacts.address}</div>`;
            if (contacts.showHours && contacts.hours) html += `<div class="contact-item"><i class="fas fa-clock"></i> ${contacts.hours}</div>`;
            document.getElementById('contactBar').innerHTML = html;
            document.getElementById('contactBarFooter').innerHTML = html;
        }

        function applyStyles() {
            document.documentElement.style.setProperty('--image-height', styles.imageHeight);
            document.documentElement.style.setProperty('--title-size', styles.titleSize);
            document.documentElement.style.setProperty('--subtitle-size', styles.subtitleSize);
            document.documentElement.style.setProperty('--item-title-size', styles.itemTitleSize);
            document.documentElement.style.setProperty('--item-description-size', styles.itemDescriptionSize);
            document.documentElement.style.setProperty('--price-size', styles.priceSize);
            document.documentElement.style.setProperty('--contact-size', styles.contactSize);
            document.documentElement.style.setProperty('--title-color', styles.titleColor);
            document.documentElement.style.setProperty('--subtitle-color', styles.subtitleColor);
            document.documentElement.style.setProperty('--item-title-color', styles.itemTitleColor);
            document.documentElement.style.setProperty('--item-description-color', styles.itemDescriptionColor);
            document.documentElement.style.setProperty('--price-color', styles.priceColor);
            document.documentElement.style.setProperty('--contact-color', styles.contactColor);
            document.documentElement.style.setProperty('--title-font', styles.titleFont);
            document.documentElement.style.setProperty('--subtitle-font', styles.subtitleFont);
            document.documentElement.style.setProperty('--item-title-font', styles.itemTitleFont);
            document.documentElement.style.setProperty('--item-description-font', styles.itemDescriptionFont);
            document.documentElement.style.setProperty('--price-font', styles.priceFont);
            document.documentElement.style.setProperty('--body-font', "'Poppins', sans-serif");
        }

        function applySettings() {
            document.getElementById('restaurantName').textContent = settings.name;
            document.getElementById('restaurantSubtitle').textContent = settings.subtitle;
            document.getElementById('footerName').textContent = settings.name;
            document.body.style.backgroundImage = `url('${settings.background}')`;
        }

        function renderCategories() {
            let html = '<button class="category-btn active" onclick="filterCategory(\\'all\\')">üçΩÔ∏è Todos</button>';
            categories.forEach(cat => html += `<button class="category-btn" onclick="filterCategory('${cat}')">${cat}</button>`);
            document.getElementById('categoriesNav').innerHTML = html;
        }

        function filterCategory(cat) {
            currentFilter = cat;
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderMenu();
        }

        function renderMenu() {
            const filtered = currentFilter === 'all' ? menuItems : menuItems.filter(item => item.category === currentFilter);
            const html = filtered.map(item => `
                <div class="menu-item" onclick="showItemDetail(${item.id})">
                    <img src="${item.image}" alt="${item.name}">
                    <div class="menu-item-content">
                        <div class="category-tag">${item.category || 'Sem categoria'}</div>
                        <h3>${item.name}</h3>
                        <p>${item.description}</p>
                        <div class="price">R$ ${item.price}</div>
                    </div>
                </div>
            `).join('');
            document.getElementById('menuGrid').innerHTML = html || '<p style="color: white; text-align: center; padding: 40px;">Nenhum item cadastrado ainda.</p>';
            if (isLoggedIn) renderAdminList();
        }

        function renderAdminList() {
            const html = '<h3 style="margin-top: 30px; color: #333;">üìã Itens do Card√°pio</h3>' +
                menuItems.map(item => `
                <div class="item-row">
                    <div><strong>${item.name}</strong> - ${item.category} - R$ ${item.price}</div>
                    <div class="item-actions">
                        <button class="btn" onclick="editItem(${item.id})">‚úèÔ∏è Editar</button>
                        <button class="btn-secondary btn" onclick="deleteItem(${item.id})">üóëÔ∏è Excluir</button>
                    </div>
                </div>
            `).join('');
            document.getElementById('itemList').innerHTML = html;
        }

        function showItemDetail(id) {
            const item = menuItems.find(i => i.id === id);
            const html = `
                <img src="${item.image}" style="width: 100%; border-radius: 10px; margin-bottom: 20px;">
                <h2>${item.name}</h2>
                <p style="color: #666; margin: 15px 0;">${item.description}</p>
                <div style="font-size: 28px; color: #ff6b6b; font-weight: bold; margin: 20px 0;">R$ ${item.price}</div>
                <button class="btn" onclick="addToCart(${id})" style="width: 100%; font-size: 18px; padding: 15px;">
                    üõí Adicionar ao Carrinho
                </button>
            `;
            document.getElementById('itemDetailContent').innerHTML = html;
            document.getElementById('itemDetailModal').style.display = 'block';
        }

        function addToCart(id) {
            const item = menuItems.find(i => i.id === id);
            const existing = cart.find(c => c.id === id);
            if (existing) existing.qty++; else cart.push({ ...item, qty: 1 });
            updateCartUI();
            closeModal('itemDetailModal');
            alert('‚úÖ Item adicionado ao carrinho!');
        }

        function updateCartUI() {
            const count = cart.reduce((sum, item) => sum + item.qty, 0);
            document.getElementById('cartCount').textContent = count;
            document.getElementById('cartFloat').style.display = count > 0 ? 'flex' : 'none';
        }

        function showCartModal() {
            if (cart.length === 0) { alert('Seu carrinho est√° vazio!'); return; }
            let html = '', total = 0;
            cart.forEach(item => {
                const subtotal = parseFloat(item.price) * item.qty;
                total += subtotal;
                html += `
                    <div class="cart-item">
                        <div class="cart-item-info"><strong>${item.name}</strong><br><small>R$ ${item.price} cada</small></div>
                        <div class="cart-item-controls">
                            <button class="qty-btn" onclick="changeQty(${item.id}, -1)">-</button>
                            <span style="margin: 0 10px; font-weight: bold;">${item.qty}</span>
                            <button class="qty-btn" onclick="changeQty(${item.id}, 1)">+</button>
                            <span style="margin-left: 15px; font-weight: bold;">R$ ${subtotal.toFixed(2)}</span>
                        </div>
                    </div>
                `;
            });
            document.getElementById('cartItems').innerHTML = html;
            document.getElementById('cartTotal').textContent = `Total: R$ ${total.toFixed(2)}`;
            document.getElementById('cartModal').style.display = 'block';
        }

        function changeQty(id, delta) {
            const item = cart.find(c => c.id === id);
            if (item) {
                item.qty += delta;
                if (item.qty <= 0) cart = cart.filter(c => c.id !== id);
                updateCartUI();
                showCartModal();
            }
        }

        function sendOrder() {
            const name = document.getElementById('customerName').value;
            const location = document.getElementById('customerLocation').value;
            if (!name || !location) { alert('‚ö†Ô∏è Preencha seu nome e localiza√ß√£o!'); return; }
            
            const now = new Date();
            const dateStr = now.toLocaleDateString('pt-BR');
            const timeStr = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            
            let total = 0;
            let itemsText = '';
            
            cart.forEach(item => {
                const subtotal = parseFloat(item.price) * item.qty;
                total += subtotal;
                itemsText += `${item.qty}x ${item.name.padEnd(20)} R$ ${subtotal.toFixed(2)}\\n`;
            });
            
            const message = `‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë     üçΩÔ∏è NOVO PEDIDO üçΩÔ∏è      ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë üìÖ Data: ${dateStr.padEnd(17)}‚ïë
‚ïë ‚è∞ Hora: ${timeStr.padEnd(17)}‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë üë§ Cliente: ${name.padEnd(15)}‚ïë
‚ïë üìç Local: ${location.padEnd(17)}‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë         üìã ITENS           ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
${itemsText.split('\\n').filter(l => l).map(l => '‚ïë ' + l.padEnd(25) + '‚ïë').join('\\n')}
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë üí∞ TOTAL: R$ ${total.toFixed(2).padStart(12)} ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚úÖ Pedido realizado via Card√°pio Digital`;
            
            const whatsapp = contacts.whatsapp.replace(/\\D/g, '');
            const url = `https://wa.me/${whatsapp}?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
            cart = [];
            updateCartUI();
            closeModal('cartModal');
            alert('‚úÖ Pedido enviado! Aguarde a confirma√ß√£o.');
        }

        function showCategoriesModal() {
            renderCategoriesList();
            document.getElementById('categoriesModal').style.display = 'block';
        }

        function renderCategoriesList() {
            const html = categories.map((cat, idx) => `
                <div class="item-row">
                    <div><strong>${cat}</strong></div>
                    <div class="item-actions">
                        <button class="btn-secondary btn" onclick="deleteCategory(${idx})">üóëÔ∏è Excluir</button>
                    </div>
                </div>
            `).join('');
            document.getElementById('categoriesList').innerHTML = html;
        }

        function addCategory() {
            const name = document.getElementById('newCategoryName').value.trim();
            if (!name) { alert('Digite o nome da categoria!'); return; }
            if (categories.includes(name)) { alert('Categoria j√° existe!'); return; }
            categories.push(name);
            saveToFirebase('categories', categories);
            saveToLocalStorage();
            renderCategories();
            renderCategoriesList();
            document.getElementById('newCategoryName').value = '';
            alert('‚úÖ Categoria adicionada!');
        }

        function deleteCategory(idx) {
            if (confirm('Excluir esta categoria?')) {
                categories.splice(idx, 1);
                saveToFirebase('categories', categories);
                saveToLocalStorage();
                renderCategories();
                renderCategoriesList();
            }
        }

        function showLoginModal() {
            if (isLoggedIn) {
                document.getElementById('adminPanel').style.display = 'block';
                window.scrollTo(0, 0);
            } else {
                document.getElementById('loginModal').style.display = 'block';
            }
        }

        function login() {
            const password = document.getElementById('loginPassword').value;
            if (password === settings.password) {
                isLoggedIn = true;
                closeModal('loginModal');
                document.getElementById('adminPanel').style.display = 'block';
                renderMenu();
                alert('‚úÖ Login realizado!');
            } else {
                alert('‚ùå Senha incorreta!');
            }
        }

        function logout() {
            isLoggedIn = false;
            document.getElementById('adminPanel').style.display = 'none';
            alert('üëã Logout realizado!');
        }

        function showContactModal() {
            document.getElementById('contactWhatsapp').value = contacts.whatsapp;
            document.getElementById('contactPhone').value = contacts.phone;
            document.getElementById('contactInstagram').value = contacts.instagram;
            document.getElementById('contactFacebook').value = contacts.facebook;
            document.getElementById('contactEmail').value = contacts.email;
            document.getElementById('contactAddress').value = contacts.address;
            document.getElementById('contactHours').value = contacts.hours;
            document.getElementById('showWhatsapp').checked = contacts.showWhatsapp !== false;
            document.getElementById('showPhone').checked = contacts.showPhone === true;
            document.getElementById('showInstagram').checked = contacts.showInstagram !== false;
            document.getElementById('showFacebook').checked = contacts.showFacebook === true;
            document.getElementById('showEmail').checked = contacts.showEmail !== false;
            document.getElementById('showAddress').checked = contacts.showAddress !== false;
            document.getElementById('showHours').checked = contacts.showHours !== false;
            document.getElementById('contactModal').style.display = 'block';
        }

        function saveContacts() {
            contacts.whatsapp = document.getElementById('contactWhatsapp').value;
            contacts.phone = document.getElementById('contactPhone').value;
            contacts.instagram = document.getElementById('contactInstagram').value;
            contacts.facebook = document.getElementById('contactFacebook').value;
            contacts.email = document.getElementById('contactEmail').value;
            contacts.address = document.getElementById('contactAddress').value;
            contacts.hours = document.getElementById('contactHours').value;
            contacts.showWhatsapp = document.getElementById('showWhatsapp').checked;
            contacts.showPhone = document.getElementById('showPhone').checked;
            contacts.showInstagram = document.getElementById('showInstagram').checked;
            contacts.showFacebook = document.getElementById('showFacebook').checked;
            contacts.showEmail = document.getElementById('showEmail').checked;
            contacts.showAddress = document.getElementById('showAddress').checked;
            contacts.showHours = document.getElementById('showHours').checked;
            saveToFirebase('contacts', contacts);
            saveToLocalStorage();
            renderContacts();
            closeModal('contactModal');
            alert('‚úÖ Contatos salvos!');
        }

        function showStyleModal() {
            document.getElementById('imageHeight').value = parseInt(styles.imageHeight);
            document.getElementById('titleSize').value = parseInt(styles.titleSize);
            document.getElementById('subtitleSize').value = parseInt(styles.subtitleSize);
            updateImageHeight();
            updateSizePreview('title');
            updateSizePreview('subtitle');
            document.getElementById('titleColor').value = styles.titleColor;
            document.getElementById('titleColorText').value = styles.titleColor;
            document.getElementById('subtitleColor').value = styles.subtitleColor;
            document.getElementById('subtitleColorText').value = styles.subtitleColor;
            document.getElementById('styleModal').style.display = 'block';
        }

        function updateImageHeight() {
            const val = document.getElementById('imageHeight').value;
            document.getElementById('imageHeightValue').textContent = val + 'px';
        }

        function updateSizePreview(type) {
            const val = document.getElementById(type + 'Size').value;
            document.getElementById(type + 'SizeValue').textContent = val + 'px';
        }

        function updateColorText(type) {
            const val = document.getElementById(type + 'Color').value;
            document.getElementById(type + 'ColorText').value = val;
        }

        function saveStyles() {
            styles.imageHeight = document.getElementById('imageHeight').value + 'px';
            styles.titleSize = document.getElementById('titleSize').value + 'px';
            styles.subtitleSize = document.getElementById('subtitleSize').value + 'px';
            styles.titleColor = document.getElementById('titleColor').value;
            styles.subtitleColor = document.getElementById('subtitleColor').value;
            saveToFirebase('styles', styles);
            saveToLocalStorage();
            applyStyles();
            closeModal('styleModal');
            alert('‚úÖ Estilos salvos!');
        }

        function showSettingsModal() {
            document.getElementById('settingsName').value = settings.name;
            document.getElementById('settingsSubtitle').value = settings.subtitle;
            document.getElementById('settingsBackground').value = settings.background;
            document.getElementById('settingsModal').style.display = 'block';
        }

        function saveSettings() {
            settings.name = document.getElementById('settingsName').value;
            settings.subtitle = document.getElementById('settingsSubtitle').value;
            settings.background = document.getElementById('settingsBackground').value;
            const newPass = document.getElementById('settingsPassword').value;
            if (newPass) settings.password = newPass;
            saveToFirebase('settings', settings);
            saveToLocalStorage();
            applySettings();
            closeModal('settingsModal');
            alert('‚úÖ Configura√ß√µes salvas!');
        }

        function showAddItemModal() {
            editingItemId = null;
            document.getElementById('itemModalTitle').textContent = '‚ûï Adicionar Item';
            document.getElementById('itemName').value = '';
            document.getElementById('itemDescription').value = '';
            document.getElementById('itemPrice').value = '';
            document.getElementById('itemImage').value = '';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('imageUploadArea').classList.remove('has-image');
            uploadedImageData = null;
            const catSelect = document.getElementById('itemCategory');
            catSelect.innerHTML = categories.map(c => `<option value="${c}">${c}</option>`).join('');
            document.getElementById('itemModal').style.display = 'block';
        }

        function editItem(id) {
            const item = menuItems.find(i => i.id === id);
            editingItemId = id;
            document.getElementById('itemModalTitle').textContent = '‚úèÔ∏è Editar Item';
            document.getElementById('itemName').value = item.name;
            document.getElementById('itemDescription').value = item.description;
            document.getElementById('itemPrice').value = item.price;
            document.getElementById('itemImage').value = item.image;
            document.getElementById('imagePreview').src = item.image;
            document.getElementById('imagePreview').style.display = 'block';
            document.getElementById('imageUploadArea').classList.add('has-image');
            uploadedImageData = null;
            const catSelect = document.getElementById('itemCategory');
            catSelect.innerHTML = categories.map(c => `<option value="${c}" ${c === item.category ? 'selected' : ''}>${c}</option>`).join('');
            document.getElementById('itemModal').style.display = 'block';
        }

        function saveItem() {
            const name = document.getElementById('itemName').value.trim();
            const description = document.getElementById('itemDescription').value.trim();
            const price = document.getElementById('itemPrice').value.trim();
            const category = document.getElementById('itemCategory').value;
            let image = document.getElementById('itemImage').value.trim();
            
            if (!name || !price || !category) { alert('Preencha todos os campos obrigat√≥rios!'); return; }
            
            if (uploadedImageData) image = uploadedImageData;
            if (!image) image = 'https://placehold.co/400x300/cccccc/666666?text=Sem+Imagem';
            
            if (editingItemId) {
                const item = menuItems.find(i => i.id === editingItemId);
                item.name = name;
                item.description = description;
                item.price = price;
                item.image = image;
                item.category = category;
            } else {
                const newId = menuItems.length > 0 ? Math.max(...menuItems.map(i => i.id)) + 1 : 1;
                menuItems.push({ id: newId, name, description, price, image, category });
            }
            
            saveToFirebase('menuItems', menuItems);
            saveToLocalStorage();
            renderMenu();
            renderCategories();
            closeModal('itemModal');
            alert('‚úÖ Item salvo!');
        }

        function deleteItem(id) {
            if (confirm('Excluir este item?')) {
                menuItems = menuItems.filter(i => i.id !== id);
                saveToFirebase('menuItems', menuItems);
                saveToLocalStorage();
                renderMenu();
            }
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) event.target.style.display = 'none';
        }

        initFirebase();
    </script>
</body>
</html>'''
